<%- include('../includes/auth-head.ejs') %>

<!-- STYLES -->

<!-- SCRIPTS -->
<script src="/scripts/auth-registration-form.js" defer></script>

  <main>

    <div class="auth-panel">

      <% if (typeof isPasswordChanged !== 'undefined' && isPasswordChanged) { %>

        <header>
          <h1>Password changed successfully</h1>
          <p>Now you can login using new password.</p>
          <a href="/login"><button>Return to sign in</button></a>
        </header>

      <% } else { %>

        <header>
          <h1>Change password</h1>
          <p>Enter new password.</p>
        </header>

        <form name="reset-password-form" action="/new-password" method="POST">

          <label for="user-pass" id="pass-uniq-error" style="color: red;">
            <%= typeof errors !== 'undefined' ? errors.passUniq : '' %>
          </label><br>
      
          <!-- User email -->
          <input type="hidden" name="userEmail" value="<%= email %>">

          <!-- token -->
          <input type="hidden" name="token" value="<%= token %>">

          <!-- User password input -->
          <label for="user-pass">New password</label><br>
          <input type="text" id="user-pass" name="userPass" class="registration-input" value="<%= 
            typeof inputs !== 'undefined' ? inputs.userPass : ''
          %>">
          <br><label for="user-pass" id="user-pass-error" style="color: red;">
            <%= typeof errors !== 'undefined' ? errors.userPass : '' %>
          </label>
          <section id="password-requirements">
            <strong><p>Create a password that:</p></strong>
            <ul id="requirements-list">
              <li id="password-length">contains at least 8 characters</li>
              <li id="password-letters">contains both lower (a-z) and upper case letters (A-Z)</li>
              <li id="password-symbols">contains at least one number (0-9) or underscore symbol</li>          
              <li id="password-alfa-num">does not contain non afpha numeric symbols</li>
            </ul>
          </section>
          <br>

          <!-- User password input -->  
          <label for="pass-conf">Confirm password</label><br>
          <input type="text" id="pass-conf" name="passConf" class="registration-input" value="<%= 
            typeof inputs !== 'undefined' ? inputs.passConf : ''
          %>">
          <br><label for="pass-conf" id="pass-conf-error" style="color: red;">
            <%= typeof errors !== 'undefined' ? errors.passConf : '' %>  
          </label>
          <br>
          
          <input type="submit" id="form-submit-btn" name="formSubmitBtn" value="Reset password" >
        </form>

      <% } %>

    </div>

  </main>
  
<%- include('../includes/auth-footer.ejs') %>